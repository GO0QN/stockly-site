<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Stockly • Account</title>
<link rel="stylesheet" href="styles.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
</head><body>

<!-- Header -->
<header class="site-header">
  <div class="container nav">
    <a class="brand" href="index.html"><span class="logo"></span><span>Stockly</span></a>
    <nav class="navlinks">
      <a href="index.html" data-nav="home">Home</a>
      <a href="learn.html" data-nav="learn">Learn</a>
      <a href="quiz.html" data-nav="quiz">Quiz</a>
      <a href="trade.html" data-nav="trade">Paper Trade</a>
      <a href="forums.html" data-nav="forums">Forums</a>
    </nav>
    <div class="user">
      <button class="user-btn" data-el="userBtn"><span data-el="userEmail">Guest</span> ▾</button>
      <div class="user-menu card" data-el="userMenu">
        <a href="account.html">Profile / Account</a>
        <button data-el="logoutBtn">Log out</button>
      </div>
    </div>
  </div>
</header>
<script>document.querySelectorAll('[data-nav]').forEach(a=>{if(a.getAttribute('data-nav')==='home')a.classList.remove('active')});</script>

<section class="section">
  <div class="container">
    <div class="grid">
      <div class="card span-6">
        <h2>Sign up / Log in</h2>
        <div class="grid">
          <div class="span-12"><label>Email <input id="email" class="input" type="email" placeholder="you@example.com"></label></div>
          <div class="span-12"><label>Password <input id="password" class="input" type="password" placeholder="min 6 chars"></label></div>
        </div>
        <div style="display:flex;gap:10px;margin-top:10px">
          <button class="btn btn-primary" id="signup">Create account</button>
          <button class="btn btn-ghost" id="login">Log in</button>
        </div>
        <small id="authMsg" class="muted"></small>
      </div>

      <div class="card span-6">
        <h2>Profile</h2>
        <p><b>Status:</b> <span id="status">Signed out</span></p>
        <p><b>Email:</b> <span id="p_email">—</span></p>
        <div class="grid">
          <div class="span-12"><label>Display Name <input id="displayName" class="input" placeholder="Trader Jane"></label></div>
          <div class="span-12"><button class="btn btn-primary" id="saveProfile">Save Profile</button></div>
        </div>
      </div>
    </div>
  </div>
</section>

<footer><div class="container">© <span id="year"></span> Stockly</div></footer>
<script>document.getElementById('year').textContent=new Date().getFullYear()</script>

<!-- Firebase -->
<script type="module">
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/12.2.0/firebase-auth.js";
  import "./firebase.js"; // boot + header behavior
  const { auth } = window.__stockly;

  const email = document.getElementById('email');
  const pass  = document.getElementById('password');
  const msg   = document.getElementById('authMsg');

  document.getElementById('signup').onclick = async () => {
    try { await createUserWithEmailAndPassword(auth, email.value, pass.value); msg.textContent = "Account created ✓"; }
    catch(e){ msg.textContent = e.message; }
  };
  document.getElementById('login').onclick = async () => {
    try { await signInWithEmailAndPassword(auth, email.value, pass.value); msg.textContent = "Logged in ✓"; }
    catch(e){ msg.textContent = e.message; }
  };

  const status = document.getElementById('status');
  const pEmail = document.getElementById('p_email');
  const dName  = document.getElementById('displayName');
  document.getElementById('saveProfile').onclick = async () => {
    if (!auth.currentUser) return msg.textContent = "Please log in first.";
    try { await updateProfile(auth.currentUser, { displayName: dName.value || null }); msg.textContent = "Profile saved ✓"; }
    catch(e){ msg.textContent = e.message; }
  };

  onAuthStateChanged(auth, (u)=>{
    status.textContent = u ? "Signed in" : "Signed out";
    pEmail.textContent = u?.email || "—";
    dName.value = u?.displayName || "";
  });
</script>
</body></html>
